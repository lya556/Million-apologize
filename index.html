<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<title>Math Heart</title>
<style>
    body {
        margin: 0;
        overflow: hidden;
        background: #000013;
        font-family: "Tajawal", sans-serif;
    }

    /* شبكة التربيع */
    .grid {
        position: fixed;
        inset: 0;
        background:
            linear-gradient(#ffffff08 1px, transparent 1px) 0 0 / 40px 40px,
            linear-gradient(90deg, #ffffff08 1px, transparent 1px) 0 0 / 40px 40px;
        animation: gridGlow 4s infinite alternate;
    }

    @keyframes gridGlow {
        from { opacity: 0.4; }
        to { opacity: 0.8; }
    }

    /* القلب الأساسي */
    canvas {
        position: fixed;
        inset: 0;
        margin: auto;
    }

    /* النص النهائي */
    #finalText {
        position: fixed;
        width: 100%;
        bottom: 8%;
        text-align: center;
        font-size: 26px;
        line-height: 1.7;
        color: #ff4d73;
        opacity: 0;
        filter: drop-shadow(0 0 10px #ff4d73);
        animation: fadeIn 3s forwards;
        animation-delay: 6s;
    }

    #names {
        font-size: 20px;
        margin-top: 20px;
        opacity: 0;
        animation: fadeIn 3s forwards;
        animation-delay: 8s;
    }

    @keyframes fadeIn {
        to { opacity: 1; }
    }
</style>
</head>

<body>
<div class="grid"></div>
<canvas id="heartCanvas"></canvas>

<div id="finalText">
    نعتذر بلسان الرياضيات: مجموع أسفنا أكبر من اللانهاية،  
    وحاصل ضرب ندمنا لا يحويه أي متغير  
    نرجوكِ قبل أن تحكمي على خطئنا،  
    أن تفتحي لنا دفتر مسامحتكِ وألا تضعي عليه علامة الغياب.
    <div id="names">علياء خليفة × حلى فارسي</div>
</div>

<script>
/* إعدادات الرسم */
const canvas = document.getElementById("heartCanvas");
const ctx = canvas.getContext("2d");

function resize() {
    canvas.width = innerWidth;
    canvas.height = innerHeight;
}
resize();
addEventListener("resize", resize);

/* معادلة القلب */
function heartFunction(t, scale = 12) {
    const x = scale * 16 * Math.pow(Math.sin(t), 3);
    const y = -scale * (13 * Math.cos(t) - 5 * Math.cos(2 * t)
         - 2 * Math.cos(3 * t) - Math.cos(4 * t));
    return { x, y };
}

/* نقاط تكوّن القلب */
let progress = 0;
let heartPoints = [];
let waves = [];

/* رسم القلب */
function drawHeart() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    const cx = canvas.width / 2;
    const cy = canvas.height / 2 + 20;

    // رسم نقاط القلب
    ctx.beginPath();
    ctx.strokeStyle = "#ff4d73";
    ctx.lineWidth = 2;

    for (let t = 0; t < progress; t += 0.01) {
        const p = heartFunction(t);
        ctx.lineTo(cx + p.x, cy + p.y);
    }
    ctx.stroke();

    // بعد اكتمال القلب → يبدأ بإصدار موجات
    if (progress >= Math.PI * 2) {
        waves.push({ radius: 0, alpha: 0.8 });
    }

    // رسم التموجات
    waves.forEach((w, index) => {
        ctx.beginPath();
        ctx.strokeStyle = `rgba(255, 77, 115, ${w.alpha})`;
        ctx.lineWidth = 2;
        const r = w.radius;
        ctx.ellipse(cx, cy, r * 1.4, r, 0, 0, Math.PI * 2);
        ctx.stroke();

        w.radius += 1.2;
        w.alpha -= 0.01;

        if (w.alpha <= 0) waves.splice(index, 1);
    });
}

/* الأنميشن */
function animate() {
    requestAnimationFrame(animate);

    if (progress < Math.PI * 2) {
        progress += 0.03;
    }

    drawHeart();
}

animate();
</script>

</body>
  </html>
